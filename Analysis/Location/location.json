[{"id":"7a8ca282.3de33c","type":"template","z":"a0f974bf.e5cab8","name":"","field":"payload","fieldType":"msg","format":"html","syntax":"mustache","template":"\n<!DOCTYPE html>\n<html lang=\"en\" class=\"no-js\">\n<head>\n\t<meta charset=\"utf-8\" />\n\t<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no\">\n\t<title>Cloudant Geo Exercise 0</title>\n\t<link href=\"//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css\" rel=\"stylesheet\">\n\t<link rel=\"stylesheet\" href=\"//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css\">\n\t<link rel=\"stylesheet\" href=\"style/leaflet.css\" />\n</head>\n<body>\n\t<div class=\"container\">\n      <div class=\"page-header\">\n  \t\t\t<h1>Cloudant Geo Exercise:</h1>\n  \t\t\t<h2>200 documents within 10,000 meters of the Boston State House</h2>\n      </div>\n\n    <div class=\"row\">\n      <div class=\"col-sm-12\">\n    \t\t<div id=\"map\" style=\"width: 100%; height: 480px\"></div>\n      </div>\n    </div>\n\t</div>\n\n\t<script src=\"//code.jquery.com/jquery-1.11.0.min.js\"></script>\n\t<script src=\"script/leaflet.js\"></script>\n\t<script>\n\tvar map = L.map('map').setView([42.357963, -71.063991], 12);\n\n\tL.tileLayer('https://{s}.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoicmFqcnNpbmdoIiwiYSI6ImpzeDhXbk0ifQ.VeSXCxcobmgfLgJAnsK3nw', {\n\t\tmaxZoom: 20,\n\t\tdetectRetina: true,\n\t\tid: 'mapbox.streets'\n\t}).addTo(map);\n\n\tvar cloudantURL = '../crimes/_design/crimeclass/_geo/newGeoIndex?lat=42.32111262228869&lon=-71.08926773071289&radius=3418.352547554223&limit=20&relation=contains';\n\n\tvar crimeslayer = L.geoJson(null, {\n\t\tonEachFeature: onEachFeature\n\t}).addTo(map);\n\t$.getJSON(cloudantURL, null, function onSuccess(data) {\n\t\t// for (var i = 0; i < data.features.length; i++) {\n\t\t// \tcrimeslayer.addData(data.features[i].properties.doc);\n\t\t// }\n\t\tfor (var i = 0; i < data.rows.length; i++) {\n\t\t\tif ( data.rows[i].doc.geometry ) // this skips non-GeoJSON docs, e.g. design documents\n\t\t\t\tcrimeslayer.addData(data.rows[i].doc);\n\t\t}\n\t});\n\t\n\tfunction onEachFeature(feature, layer) {\n\t\tif ( feature.properties ) {\n\t\t\tvar pop = '';\n\t\t\tfor (var k in feature.properties) {\n\t\t\t\tpop += '<b>' + k + ': </b> ' + feature.properties[k] + '<br/>';\n\t\t\t}\n\t\t\t// layer.bindPopup( JSON.stringify(feature.properties) );\n\t\t\tlayer.bindPopup(pop);\n\t\t}\n\t}\n\t</script>\n\t\n</body>","output":"json","x":111,"y":2156,"wires":[["c910153a.8e9e38"]]},{"id":"c910153a.8e9e38","type":"html","z":"a0f974bf.e5cab8","name":"","property":"payload","outproperty":"payload","tag":"","ret":"html","as":"single","x":241,"y":2136,"wires":[["2eb74a84.bee1c6"]]},{"id":"2eb74a84.bee1c6","type":"ui_template","z":"a0f974bf.e5cab8","group":"ed2fd2a1.0429a","name":"","order":3,"width":0,"height":0,"format":"<div ng-bind-html=\"msg.payload\"></div>\n<a href=\"https://cab152f2-f650-42a9-b5c1-afc30a2218db-bluemix.cloudant.com/dashboard.html#/database/geospatial/_design/geodd/_geoindex/geoidx\" style=\"color:white\">LOCATION</a>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","x":451,"y":2096,"wires":[[]]},{"id":"ed2fd2a1.0429a","type":"ui_group","z":0,"name":"LOCATION","tab":"d528786e.e7e658","order":4,"disp":true,"width":"6","collapse":false},{"id":"d528786e.e7e658","type":"ui_tab","z":0,"name":"Analysis","icon":"dashboard","order":5,"disabled":false,"hidden":false}]